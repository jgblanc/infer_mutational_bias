<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Jennifer Blanc" />


<title>CS_Results</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->



<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">infer_mutational_bias</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jgblanc/infer_mutational_bias">
    <span class="fa fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">CS_Results</h1>
<h4 class="author">Jennifer Blanc</h4>
<h4 class="date">12/2/2019</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span> workflowr <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2019-12-09
</p>
<p>
<strong>Checks:</strong> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 7 <span class="glyphicon glyphicon-exclamation-sign text-danger" aria-hidden="true"></span> 0
</p>
<p>
<strong>Knit directory:</strong> <code>infer_mutational_bias/analysis/</code> <span class="glyphicon glyphicon-question-sign" aria-hidden="true" title="This is the local directory in which the code in this file was executed."> </span>
</p>
<p>
This reproducible <a href="http://rmarkdown.rstudio.com">R Markdown</a> analysis was created with <a
  href="https://github.com/jdblischak/workflowr">workflowr</a> (version 1.4.0). The <em>Checks</em> tab describes the reproducibility checks that were applied when the results were created. The <em>Past versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguptodate"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>R Markdown file:</strong> up-to-date </a>
</p>
</div>
<div id="strongRMarkdownfilestronguptodate" class="panel-collapse collapse">
<div class="panel-body">
<p>Great! Since the R Markdown file has been committed to the Git repository, you know the exact version of the code that produced these results.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the global environment can affect the analysis in your R Markdown file in unknown ways. For reproduciblity it’s best to always run the code in an empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20191108code"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Seed:</strong> <code>set.seed(20191108)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20191108code" class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20191108)</code> was run prior to running the code in the R Markdown file. Setting a seed ensures that any results that rely on randomness, e.g. subsampling or permutations, are reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Session information:</strong> recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be confident that you successfully produced the results during this run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomjgblancinfermutationalbiastreef80bb2ee2e18e8f00af33c6faa8682ca47ed491btargetblankf80bb2ea"> <span class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> <strong>Repository version:</strong> <a href="https://github.com/jgblanc/infer_mutational_bias/tree/f80bb2ee2e18e8f00af33c6faa8682ca47ed491b" target="_blank">f80bb2e</a> </a>
</p>
</div>
<div id="strongRepositoryversionstrongahrefhttpsgithubcomjgblancinfermutationalbiastreef80bb2ee2e18e8f00af33c6faa8682ca47ed491btargetblankf80bb2ea" class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development and connecting the code version to the results is critical for reproducibility. The version displayed above was the version of the Git repository at the time these results were generated. <br><br> Note that you need to be careful to ensure that all relevant files for the analysis have been committed to Git prior to generating the results (you can use <code>wflow_publish</code> or <code>wflow_git_commit</code>). workflowr only checks the R Markdown file, but you know if there are other scripts or data files that it depends on. Below is the status of the Git repository when the results were generated:
</p>
<pre><code>
Ignored files:
    Ignored:    .DS_Store
    Ignored:    .Rhistory
    Ignored:    .Rproj.user/
    Ignored:    .snakemake/conda-archive/
    Ignored:    .snakemake/conda/
    Ignored:    .snakemake/locks/
    Ignored:    .snakemake/scripts/
    Ignored:    .snakemake/shadow/
    Ignored:    .snakemake/singularity/
    Ignored:    data/47UKBB/
    Ignored:    output/.DS_Store
    Ignored:    output/47UKBB/

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not included in this status report because it is ok for generated content to have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the R Markdown and HTML files. If you’ve configured a remote Git repository (see <code>?wflow_git_remote</code>), click on the hyperlinks in the table below to view them.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/f80bb2ee2e18e8f00af33c6faa8682ca47ed491b/analysis/CS_results.Rmd" target="_blank">f80bb2e</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-09
</td>
<td>
fixed RAF plot
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jgblanc/infer_mutational_bias/20ae584e6082f36520d9c7ba44bebcee7b7990a7/docs/CS_results.html" target="_blank">20ae584</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-09
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/702e047d6756aacf00816cf950a7d4c7371c9dd7/analysis/CS_results.Rmd" target="_blank">702e047</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-09
</td>
<td>
Addes all traits
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jgblanc/infer_mutational_bias/76ee01773c578a2d7d5c80032769d9564276d07d/docs/CS_results.html" target="_blank">76ee017</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-03
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/d739aa78936451dc5cd51447146b885c0af5110b/analysis/CS_results.Rmd" target="_blank">d739aa7</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-03
</td>
<td>
Worked on sample analysis
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jgblanc/infer_mutational_bias/b1c64207b927a16f586bd6a30fa51ac61f5ff25d/docs/CS_results.html" target="_blank">b1c6420</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-02
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/d847430f708142d68d168eeab95da6d116cb5914/analysis/CS_results.Rmd" target="_blank">d847430</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-02
</td>
<td>
Fixed typo
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jgblanc/infer_mutational_bias/f24560151e5ebbfe4b14c3551e9477eacabbba61/docs/CS_results.html" target="_blank">f245601</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-02
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/f73f5ce459beb958ecdd4f6234187d9a3911e7b0/analysis/CS_results.Rmd" target="_blank">f73f5ce</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-02
</td>
<td>
Fixed table
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/jgblanc/infer_mutational_bias/d501548d967ef91d377dfea94686709b0e4dbd6e/docs/CS_results.html" target="_blank">d501548</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-02
</td>
<td>
Build site.
</td>
</tr>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/76aeb72ddd7f4a731525e51064b1d8a95d743e76/analysis/CS_results.Rmd" target="_blank">76aeb72</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-02
</td>
<td>
Started analyzing cs results
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Here I will first outline the data processing I did on the data we got from this paper <a href="https://www.biorxiv.org/content/10.1101/807792v2">link</a>. After I outline all of the data processing, I will look at the data for HDL and see what we have.</p>
<p>From Omer directly we recieved 8 .parquet files that had the alpha values from SUSIE for all of the SNPs used in the analysis. For each of the four traits we asked for (HDL, LDL, Height, and Cardiovascular disease) we got an .parquet alpha file for both functionally and non-functionally informed fine-mapping analysis. I wrote a script (code/parse_alphas_47UKBB.R) to create credible sets from each alpha file. The goal of this script is to create 95% credible sets from the alpha values. It loops through the SNPs on each chromosome and then loops through each region in the chromosome. While the 3Mb regions are overlapping, SNPs in the alpha file are only listed onece, in the regions for which they are most central to. Within each region I sorted all the SNPs on the alpha_1 column and calculated the cumulative sum, I took the first x number of SNPs until the cumulative sum was greater than 0.95 and assigned them a unique ID (chr:region:cs). I repeated this for all 10 alpha columns in the region.</p>
<p>The table below shows the number of SNPs in the alpha files:</p>
<table>
<thead>
<tr class="header">
<th>Trait</th>
<th align="center">alphas</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>HDL</td>
<td align="center">15589643</td>
</tr>
<tr class="even">
<td>LDL</td>
<td align="center">11708765</td>
</tr>
<tr class="odd">
<td>Cardio</td>
<td align="center">15236185</td>
</tr>
<tr class="even">
<td>Height</td>
<td align="center">16820494</td>
</tr>
</tbody>
</table>
<p>From Omer I also recieved 4 files (one per trait) named bolt_337K_unrelStringentBrit_MAF0.001_v3.{trait}.bgen.stats that contains the bolt summary statistics for all the SNPs listed in the alpha files (and more). This file also includes the frequency of the effect allele (A1).<br />
After I sorted the alpha files as described above, I simply joined that data frame to the bolt data. I kept all of SNPs from the alpha file that fell into a CS and just added the bolt info for those SNPs (left_join). So the output of the parse_alphas_47UKBB.R script is a table with all the SNPs that I assigned to a CS with all their information and the bolt GWAS information.</p>
<p>Next I used a series of scripts to figure out which allele is derived for each SNP and the frequencies of different alleles. First I recyled a script (code/get_evolutionary_information_from_1kg_rsID.py) which takes file I have from 1000 Genomes which lists which allele at each SNP is the derived one and the output of my parsed_alpha script and check if the A1 allele (the effect allele) is derived or not and records T or F in an additional column.</p>
<p>We now have all the information we need. The final script (code/get_RAF.R) just adds a bunch of columns we might be interested in. First it checks the sign of the BETA column and assigns the SNP as risk or protective (postive beta = risk). It then calculates the risk allele frequency (1 - EAF, if a protective SNP) and derived allele frequency (1 - EAF, if EA ancestral), and MAF (1 - EAF, if EAF &gt;= 0.5). I also split up the unique ID into separate columns to make it easier to works with. I also transform the BETA (calculated from a standardized genotype matrix) to a biologically meaningful effect size, by dividing the BETA column by sqrt(2 x MAF x (1 - MAF)), I call this column ES for effect size.</p>
</div>
<div id="summary-of-data" class="section level2">
<h2>Summary of Data</h2>
<p>Load processed data</p>
<pre class="r"><code>height &lt;- fread(&quot;../output/47UKBB/RAF_info_added/body_HEIGHTz_RAF.txt&quot;)
HDL &lt;- fread(&quot;../output/47UKBB/RAF_info_added/biochemistry_HDLcholesterol_RAF.txt&quot;)
LDL &lt;- fread(&quot;../output/47UKBB/RAF_info_added/biochemistry_LDLdirect_RAF.txt&quot;)
cardio &lt;- fread(&quot;../output/47UKBB/RAF_info_added/disease_CARDIOVASCULAR_RAF.txt&quot;)</code></pre>
<p><strong>How many SNPs do we have and how many SNPs fall into more than one CS?</strong></p>
<p>Height - We have 379,600 SNPs, 19883 of them fall in more than one CS</p>
<pre class="r"><code>nrow(height)</code></pre>
<pre><code>[1] 379600</code></pre>
<pre class="r"><code>table(duplicated(height$SNP))</code></pre>
<pre><code>
 FALSE   TRUE 
180770 198830 </code></pre>
<p>HDL - We have 109,271 SNPs, 55,488 of them fall in more than one CS</p>
<pre class="r"><code>nrow(HDL)</code></pre>
<pre><code>[1] 109271</code></pre>
<pre class="r"><code>table(duplicated(HDL$SNP))</code></pre>
<pre><code>
FALSE  TRUE 
53783 55488 </code></pre>
<p>LDL - We have 129,616 SNPs, 86,623 of them fall in more than one CS</p>
<pre class="r"><code>nrow(LDL)</code></pre>
<pre><code>[1] 129616</code></pre>
<pre class="r"><code>table(duplicated(LDL$SNP))</code></pre>
<pre><code>
FALSE  TRUE 
42993 86623 </code></pre>
<p>Cardio - We have 39,662 SNPs, 43 of them fall in more than one CS</p>
<pre class="r"><code>nrow(cardio)</code></pre>
<pre><code>[1] 39662</code></pre>
<pre class="r"><code>table(duplicated(cardio$SNP))</code></pre>
<pre><code>
FALSE  TRUE 
39619    43 </code></pre>
<p><strong>How many unique credible sets did we make?</strong></p>
<p>Height</p>
<pre class="r"><code>length(unique(height$UNIQ_ID))</code></pre>
<pre><code>[1] 2563</code></pre>
<p>HDL</p>
<pre class="r"><code>length(unique(HDL$UNIQ_ID))</code></pre>
<pre><code>[1] 563</code></pre>
<p>LDL</p>
<pre class="r"><code>length(unique(LDL$UNIQ_ID))</code></pre>
<pre><code>[1] 247</code></pre>
<p>Cardio</p>
<pre class="r"><code>length(unique(cardio$UNIQ_ID))</code></pre>
<pre><code>[1] 232</code></pre>
<p>We have the bolt summary statistics for the all the SNPs in all of our credible sets in all 4 of our traits.</p>
<p><strong>What is the distribution of number of SNPs in a credible set?</strong></p>
<pre class="r"><code>counts_height &lt;- height %&gt;% group_by(UNIQ_ID) %&gt;% tally() 
counts_HDL &lt;- HDL %&gt;% group_by(UNIQ_ID) %&gt;% tally()
counts_LDL &lt;- LDL %&gt;% group_by(UNIQ_ID) %&gt;% tally()
counts_cardio &lt;- cardio %&gt;% group_by(UNIQ_ID) %&gt;% tally()

p1 &lt;- ggplot(counts_height, aes(x = n)) + geom_histogram(bins=50, fill = &quot;darkred&quot;) + theme_bw() + ggtitle(&quot;Height&quot;) + theme(plot.title = element_text(hjust = 0.5))
p2 &lt;- ggplot(counts_HDL, aes(x = n)) + geom_histogram(bins=50, fill = &quot;gold&quot;) + theme_bw() + ggtitle(&quot;HDL&quot;) + theme(plot.title = element_text(hjust = 0.5))
p3 &lt;- ggplot(counts_LDL, aes(x = n)) + geom_histogram(bins=50, fill = &quot;darkgreen&quot;) + theme_bw() + ggtitle(&quot;LDL&quot;) + theme(plot.title = element_text(hjust = 0.5))
p4 &lt;- ggplot(counts_cardio, aes(x = n)) + geom_histogram(bins=50, fill = &quot;darkblue&quot;) + theme_bw() + ggtitle(&quot;Cardio&quot;) + theme(plot.title = element_text(hjust = 0.5))


ggarrange(p1, p2, p3, p4)</code></pre>
<p><img src="figure/CS_results.Rmd/unnamed-chunk-10-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-10-1">
Past versions of unnamed-chunk-10-1.png
</button>
</p>
<div id="fig-unnamed-chunk-10-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/20ae584e6082f36520d9c7ba44bebcee7b7990a7/docs/figure/CS_results.Rmd/unnamed-chunk-10-1.png" target="_blank">20ae584</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-09
</td>
</tr>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/76ee01773c578a2d7d5c80032769d9564276d07d/docs/figure/CS_results.Rmd/unnamed-chunk-10-1.png" target="_blank">76ee017</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-03
</td>
</tr>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/d501548d967ef91d377dfea94686709b0e4dbd6e/docs/figure/CS_results.Rmd/unnamed-chunk-10-1.png" target="_blank">d501548</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-02
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Height: The largest CS’s are on chromosome 5 (n~17,000), the are also CS’s (n~11,000) that look like they are in the long range LD region of chromosome 8.<br />
HDL: The largest CS’s (n~13,000) are in the long range chr 8 LD region<br />
LDL: The largest CS’s (n~14,000) are in the long range chr 8 LD region<br />
Cardio: The largest CS (n~11,000) is on chromosome 16 and the next largest is on chromosome 11 near (2 megabases before) the long range LD listed in the paper</p>
<p>Let’s remove all credible sets with more than 100 SNPs and look at the distribution of number of SNPs in CS’s again:</p>
<pre class="r"><code>counts_height &lt;- subset(counts_height, counts_height$n &lt;= 100) 
counts_HDL &lt;- subset(counts_HDL, counts_HDL$n &lt;= 100) 
counts_LDL &lt;- subset(counts_LDL, counts_LDL$n &lt;= 100) 
counts_cardio &lt;- subset(counts_cardio, counts_cardio$n &lt;= 100) 

p1 &lt;- ggplot(counts_height, aes(x = n)) + geom_histogram(bins=50, fill = &quot;darkred&quot;) + theme_bw() + ggtitle(&quot;Height&quot;) + theme(plot.title = element_text(hjust = 0.5))
p2 &lt;- ggplot(counts_HDL, aes(x = n)) + geom_histogram(bins=50, fill = &quot;gold&quot;) + theme_bw() + ggtitle(&quot;HDL&quot;) + theme(plot.title = element_text(hjust = 0.5))
p3 &lt;- ggplot(counts_LDL, aes(x = n)) + geom_histogram(bins=50, fill = &quot;darkgreen&quot;) + theme_bw() + ggtitle(&quot;LDL&quot;) + theme(plot.title = element_text(hjust = 0.5))
p4 &lt;- ggplot(counts_cardio, aes(x = n)) + geom_histogram(bins=50, fill = &quot;darkblue&quot;) + theme_bw() + ggtitle(&quot;Cardio&quot;) + theme(plot.title = element_text(hjust = 0.5))


ggarrange(p1, p2, p3, p4)</code></pre>
<p><img src="figure/CS_results.Rmd/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-11-1">
Past versions of unnamed-chunk-11-1.png
</button>
</p>
<div id="fig-unnamed-chunk-11-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/20ae584e6082f36520d9c7ba44bebcee7b7990a7/docs/figure/CS_results.Rmd/unnamed-chunk-11-1.png" target="_blank">20ae584</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-09
</td>
</tr>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/76ee01773c578a2d7d5c80032769d9564276d07d/docs/figure/CS_results.Rmd/unnamed-chunk-11-1.png" target="_blank">76ee017</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-03
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="sample-analysis" class="section level2">
<h2>Sample analysis</h2>
<p><strong>RAF</strong></p>
<p>Using the data we have, I’m doing to try and look at a few thing that I think are interesting. The first thing I want to look at is the average risk allele frequency. To do this I will take the weigted average of the risk allele freq in all of the CS’s for each trait.</p>
<pre class="r"><code>avg_height &lt;- height%&gt;% group_by(UNIQ_ID) %&gt;% summarise(height = (sum(RAF * ALPHA)/sum(ALPHA))) %&gt;% select(height)
avg_HDL &lt;- HDL %&gt;% group_by(UNIQ_ID) %&gt;% summarise(HDL = (sum(RAF * ALPHA)/sum(ALPHA))) %&gt;% select(HDL)
avg_LDL &lt;- LDL %&gt;% group_by(UNIQ_ID) %&gt;% summarise(LDL = (sum(RAF * ALPHA)/sum(ALPHA))) %&gt;% select(LDL)
avg_cardio &lt;- cardio %&gt;% group_by(UNIQ_ID) %&gt;% summarise(cardio = (sum(RAF * ALPHA)/sum(ALPHA))) %&gt;% select(cardio)

avg_RAF &lt;- cbind.fill(avg_height, avg_HDL, avg_LDL, avg_cardio, fill = NA)
avg_RAF &lt;- melt(avg_RAF)</code></pre>
<pre><code>No id variables; using all as measure variables</code></pre>
<pre class="r"><code>cols &lt;- c(&quot;darkred&quot;, &quot;gold&quot;, &quot;darkgreen&quot;, &quot;darkblue&quot;)
ggplot(avg_RAF, aes(y=value, x=variable, color = variable)) + geom_beeswarm() + scale_color_manual(values = cols) + theme_bw() + ylab(&quot;RAF&quot;)</code></pre>
<pre><code>Warning: Removed 6647 rows containing missing values (position_beeswarm).</code></pre>
<p><img src="figure/CS_results.Rmd/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-12-1">
Past versions of unnamed-chunk-12-1.png
</button>
</p>
<div id="fig-unnamed-chunk-12-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/20ae584e6082f36520d9c7ba44bebcee7b7990a7/docs/figure/CS_results.Rmd/unnamed-chunk-12-1.png" target="_blank">20ae584</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-09
</td>
</tr>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/76ee01773c578a2d7d5c80032769d9564276d07d/docs/figure/CS_results.Rmd/unnamed-chunk-12-1.png" target="_blank">76ee017</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-03
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>All four traits have an average risk allele frequency of ~0.5 and have a fairly even distribution across all possible risk allele frequencies.</p>
<p><strong>Distribution of derived alleles</strong></p>
<p>We are also interested in the distribution of derived risk allels vs ancestral risk alleles. First we wil plot the absolute value of the effect size vs risk allele frequency colored by the evolutionary status of the risk allele for all SNPs that are in credible sets (note I remove duplicated SNPs that fall in multiple credible sets)</p>
<pre class="r"><code>p1 &lt;- height %&gt;%  distinct(SNP, .keep_all = TRUE) %&gt;% ggplot(aes(x=RAF,y=abs(ES), color = RISK_DERIVED)) + geom_point(alpha = 0.5) + theme_bw() + scale_color_manual(values = c(&quot;darkred&quot;,&quot;navy&quot;)) + ggtitle(&quot;Height&quot;) + theme(plot.title = element_text(hjust = 0.5))
p2 &lt;- HDL %&gt;% distinct(SNP, .keep_all = TRUE) %&gt;% ggplot(aes(x=RAF,y=abs(ES), color = RISK_DERIVED)) + geom_point(alpha = 0.5) + theme_bw() + scale_color_manual(values = c(&quot;darkred&quot;,&quot;navy&quot;)) + ggtitle(&quot;HDL&quot;) + theme(plot.title = element_text(hjust = 0.5))
p3 &lt;- LDL %&gt;% distinct(SNP, .keep_all = TRUE) %&gt;% ggplot(aes(x=RAF,y=abs(ES), color = RISK_DERIVED)) + geom_point(alpha = 0.5) + theme_bw() + scale_color_manual(values = c(&quot;darkred&quot;,&quot;navy&quot;)) + ggtitle(&quot;LDL&quot;) + theme(plot.title = element_text(hjust = 0.5))
p4 &lt;- cardio %&gt;% distinct(SNP, .keep_all = TRUE) %&gt;% ggplot(aes(x=RAF,y=abs(ES), color = RISK_DERIVED)) + geom_point(alpha = 0.5) + theme_bw() + scale_color_manual(values = c(&quot;darkred&quot;,&quot;navy&quot;)) + ggtitle(&quot;Cardio&quot;) + theme(plot.title = element_text(hjust = 0.5))

ggarrange(p1,p2,p3,p4, common.legend = T, legend = &quot;bottom&quot;)</code></pre>
<p><img src="figure/CS_results.Rmd/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-13-1">
Past versions of unnamed-chunk-13-1.png
</button>
</p>
<div id="fig-unnamed-chunk-13-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/20ae584e6082f36520d9c7ba44bebcee7b7990a7/docs/figure/CS_results.Rmd/unnamed-chunk-13-1.png" target="_blank">20ae584</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-09
</td>
</tr>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/76ee01773c578a2d7d5c80032769d9564276d07d/docs/figure/CS_results.Rmd/unnamed-chunk-13-1.png" target="_blank">76ee017</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-03
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>What I’m confused about in these plots is the shape - they look less U shaped and instead have sharp conrners. I’m thinking its because we don’t actually have a ‘threshold’ for calling a single variant significant. So we have a bunch of variants with very small effect sizes that are included in large CS’s? I’m not sure about the variants with effect sizes &gt; 100, is that normal?</p>
<p>Now let’s use a weighted average of the effect size within each CS</p>
<pre class="r"><code>p1 &lt;- height %&gt;% group_by(UNIQ_ID) %&gt;% summarise(ES = (sum(ES * ALPHA)/sum(ALPHA)), raf = (sum(RAF *ALPHA)/sum(ALPHA))) %&gt;% ggplot(aes(x=raf,y=abs(ES))) + geom_point(color = &quot;darkred&quot;) + theme_bw() +  ggtitle(&quot;Height&quot;) + theme(plot.title = element_text(hjust = 0.5))
p2 &lt;- HDL %&gt;% group_by(UNIQ_ID) %&gt;% summarise(ES = (sum(ES * ALPHA)/sum(ALPHA)), raf = (sum(RAF *ALPHA)/sum(ALPHA))) %&gt;% ggplot(aes(x=raf,y=abs(ES))) + geom_point(color = &quot;gold&quot;) + theme_bw() +  ggtitle(&quot;HDL&quot;) + theme(plot.title = element_text(hjust = 0.5))
p3 &lt;- LDL %&gt;% group_by(UNIQ_ID) %&gt;% summarise(ES = (sum(ES * ALPHA)/sum(ALPHA)), raf = (sum(RAF *ALPHA)/sum(ALPHA))) %&gt;% ggplot(aes(x=raf,y=abs(ES))) + geom_point(color = &quot;darkgreen&quot;) + theme_bw() +  ggtitle(&quot;LDL&quot;) + theme(plot.title = element_text(hjust = 0.5))
p4 &lt;- cardio %&gt;% group_by(UNIQ_ID) %&gt;% summarise(ES = (sum(ES * ALPHA)/sum(ALPHA)), raf = (sum(RAF *ALPHA)/sum(ALPHA))) %&gt;% ggplot(aes(x=raf,y=abs(ES))) + geom_point(color = &quot;darkblue&quot;) + theme_bw() +  ggtitle(&quot;Cardio&quot;) + theme(plot.title = element_text(hjust = 0.5))

ggarrange(p1,p2,p3,p4, common.legend = T, legend = &quot;bottom&quot;)</code></pre>
<p><img src="figure/CS_results.Rmd/unnamed-chunk-14-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-14-1">
Past versions of unnamed-chunk-14-1.png
</button>
</p>
<div id="fig-unnamed-chunk-14-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/20ae584e6082f36520d9c7ba44bebcee7b7990a7/docs/figure/CS_results.Rmd/unnamed-chunk-14-1.png" target="_blank">20ae584</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-09
</td>
</tr>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/76ee01773c578a2d7d5c80032769d9564276d07d/docs/figure/CS_results.Rmd/unnamed-chunk-14-1.png" target="_blank">76ee017</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-03
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can’t really color by the derived ancestral status because there are multiple SNPs with different status’s in each set - we will compare proportion of derived/ancestral alleles within each set in the next section.</p>
<p><strong>Distribution of D/A alleles in CS</strong></p>
<p>First let’s pick a few regions with multiple credible sets:</p>
<pre class="r"><code>ms_region &lt;- subset(height, height$CHR == 1 &amp; height$REGION_ID == 2)
ggplot(ms_region, aes(x=BP, y=ES, color = RISK_DERIVED, shape = as.factor(CS_ID))) + geom_point() + theme_bw() +  ggtitle(&quot;Height&quot;) + theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="figure/CS_results.Rmd/unnamed-chunk-15-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-15-1">
Past versions of unnamed-chunk-15-1.png
</button>
</p>
<div id="fig-unnamed-chunk-15-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/20ae584e6082f36520d9c7ba44bebcee7b7990a7/docs/figure/CS_results.Rmd/unnamed-chunk-15-1.png" target="_blank">20ae584</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-09
</td>
</tr>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/76ee01773c578a2d7d5c80032769d9564276d07d/docs/figure/CS_results.Rmd/unnamed-chunk-15-1.png" target="_blank">76ee017</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-03
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>ms_region &lt;- subset(HDL, HDL$CHR == 1 &amp; HDL$REGION_ID == 21)
ggplot(ms_region, aes(x=BP, y=ES, color = RISK_DERIVED, shape = as.factor(CS_ID))) + geom_point() + theme_bw() +  ggtitle(&quot;HDL&quot;) + theme(plot.title = element_text(hjust = 0.5))</code></pre>
<p><img src="figure/CS_results.Rmd/unnamed-chunk-16-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-16-1">
Past versions of unnamed-chunk-16-1.png
</button>
</p>
<div id="fig-unnamed-chunk-16-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/20ae584e6082f36520d9c7ba44bebcee7b7990a7/docs/figure/CS_results.Rmd/unnamed-chunk-16-1.png" target="_blank">20ae584</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-09
</td>
</tr>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/76ee01773c578a2d7d5c80032769d9564276d07d/docs/figure/CS_results.Rmd/unnamed-chunk-16-1.png" target="_blank">76ee017</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-03
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Its hard to learn anything by just looking at a few regions…let’s try to group CS and look at the proportion of risk alleles that are derived within a credible set.</p>
<pre class="r"><code>p1 &lt;- height %&gt;% drop_na(RISK_DERIVED) %&gt;% group_by(UNIQ_ID) %&gt;% summarise(prop_ad = (sum(RISK_DERIVED == T)/n())) %&gt;% ggplot(aes(x=prop_ad)) + geom_histogram(fill = &quot;darkred&quot;, bins = 40) + theme_bw() +  ggtitle(&quot;Height&quot;) + theme(plot.title = element_text(hjust = 0.5))
p2 &lt;- HDL %&gt;% drop_na(RISK_DERIVED) %&gt;% group_by(UNIQ_ID) %&gt;% summarise(prop_ad = (sum(RISK_DERIVED == T)/n())) %&gt;% ggplot(aes(x=prop_ad)) + geom_histogram(fill = &quot;gold&quot;, bins = 40) + theme_bw() +  ggtitle(&quot;HDL&quot;) + theme(plot.title = element_text(hjust = 0.5))
p3 &lt;- LDL %&gt;% drop_na(RISK_DERIVED) %&gt;% group_by(UNIQ_ID) %&gt;% summarise(prop_ad = (sum(RISK_DERIVED == T)/n())) %&gt;% ggplot(aes(x=prop_ad)) + geom_histogram(fill = &quot;darkgreen&quot;, bins = 40) + theme_bw() +  ggtitle(&quot;LDL&quot;) + theme(plot.title = element_text(hjust = 0.5))
p4 &lt;- cardio %&gt;% drop_na(RISK_DERIVED) %&gt;% group_by(UNIQ_ID) %&gt;% summarise(prop_ad = (sum(RISK_DERIVED == T)/n())) %&gt;% ggplot(aes(x=prop_ad)) + geom_histogram(fill = &quot;darkblue&quot;, bins = 40) + theme_bw() +  ggtitle(&quot;Cardio&quot;) + theme(plot.title = element_text(hjust = 0.5))

ggarrange(p1,p2,p3,p4, common.legend = T, legend = &quot;bottom&quot;)</code></pre>
<p><img src="figure/CS_results.Rmd/unnamed-chunk-17-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-17-1">
Past versions of unnamed-chunk-17-1.png
</button>
</p>
<div id="fig-unnamed-chunk-17-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/20ae584e6082f36520d9c7ba44bebcee7b7990a7/docs/figure/CS_results.Rmd/unnamed-chunk-17-1.png" target="_blank">20ae584</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>For all traits approximately half of the credible sets have either all derived or all ancestral alleles, now we will compare the proportion of derived risk alleles within a credible set to the average RAF within the set.</p>
<p><strong>weight by ALPHA</strong></p>
<pre class="r"><code>p1 &lt;- height %&gt;% drop_na(RISK_DERIVED) %&gt;% group_by(UNIQ_ID) %&gt;% summarise(prop_ad = (sum((RISK_DERIVED == T) * ALPHA)/sum(ALPHA)), raf = (sum(RAF * ALPHA)/sum(ALPHA))) %&gt;% ggplot(aes(x=raf, y=prop_ad)) + geom_point(color = &quot;darkred&quot;) + theme_bw() + ylab(&quot;Proportion of derived risk alleles&quot;) + ggtitle(&quot;Height&quot;) + theme(plot.title = element_text(hjust = 0.5))
p2 &lt;- HDL %&gt;% drop_na(RISK_DERIVED) %&gt;% group_by(UNIQ_ID) %&gt;% summarise(prop_ad = (sum((RISK_DERIVED == T) * ALPHA)/sum(ALPHA)), raf = (sum(RAF * ALPHA)/sum(ALPHA))) %&gt;% ggplot(aes(x=raf, y=prop_ad)) + geom_point(color = &quot;gold&quot;) + theme_bw() + ylab(&quot;Proportion of derived risk alleles&quot;) + ggtitle(&quot;HDL&quot;) + theme(plot.title = element_text(hjust = 0.5))
p3 &lt;- LDL %&gt;% drop_na(RISK_DERIVED) %&gt;% group_by(UNIQ_ID) %&gt;% summarise(prop_ad = (sum((RISK_DERIVED == T) * ALPHA)/sum(ALPHA)), raf = (sum(RAF * ALPHA)/sum(ALPHA))) %&gt;% ggplot(aes(x=raf, y=prop_ad)) + geom_point(color = &quot;darkgreen&quot;) + theme_bw() + ylab(&quot;Proportion of derived risk alleles&quot;) + ggtitle(&quot;LDL&quot;) + theme(plot.title = element_text(hjust = 0.5))
p4 &lt;- cardio %&gt;% drop_na(RISK_DERIVED) %&gt;% group_by(UNIQ_ID) %&gt;% summarise(prop_ad = (sum((RISK_DERIVED == T) * ALPHA)/sum(ALPHA)), raf = (sum(RAF * ALPHA)/sum(ALPHA))) %&gt;% ggplot(aes(x=raf, y=prop_ad)) + geom_point(color = &quot;darkblue&quot;) + theme_bw() + ylab(&quot;Proportion of derived risk alleles&quot;) + ggtitle(&quot;Cardio&quot;) + theme(plot.title = element_text(hjust = 0.5))

ggarrange(p1,p2,p3,p4, common.legend = T, legend = &quot;bottom&quot; )</code></pre>
<p><img src="figure/CS_results.Rmd/unnamed-chunk-18-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-18-1">
Past versions of unnamed-chunk-18-1.png
</button>
</p>
<div id="fig-unnamed-chunk-18-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/jgblanc/infer_mutational_bias/blob/20ae584e6082f36520d9c7ba44bebcee7b7990a7/docs/figure/CS_results.Rmd/unnamed-chunk-18-1.png" target="_blank">20ae584</a>
</td>
<td>
jgblanc
</td>
<td>
2019-12-09
</td>
</tr>
</tbody>
</table>
</div>
</div>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span> Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 3.5.1 (2018-07-02)
Platform: x86_64-apple-darwin15.6.0 (64-bit)
Running under: macOS High Sierra 10.13.6

Matrix products: default
BLAS: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRblas.0.dylib
LAPACK: /Library/Frameworks/R.framework/Versions/3.5/Resources/lib/libRlapack.dylib

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] ggbeeswarm_0.6.0  rowr_1.1.3        ggpubr_0.2       
 [4] magrittr_1.5      arrow_0.15.0      forcats_0.4.0    
 [7] stringr_1.4.0     dplyr_0.8.1       purrr_0.3.2      
[10] readr_1.3.1       tidyr_0.8.3       tibble_2.1.3     
[13] ggplot2_3.2.1     tidyverse_1.2.1   data.table_1.12.2

loaded via a namespace (and not attached):
 [1] beeswarm_0.2.3   tidyselect_0.2.5 xfun_0.7         reshape2_1.4.3  
 [5] haven_2.1.0      lattice_0.20-38  colorspace_1.4-1 generics_0.0.2  
 [9] htmltools_0.3.6  yaml_2.2.0       rlang_0.4.1      pillar_1.4.2    
[13] glue_1.3.1       withr_2.1.2      bit64_0.9-7      modelr_0.1.4    
[17] readxl_1.3.1     plyr_1.8.4       lifecycle_0.1.0  munsell_0.5.0   
[21] gtable_0.3.0     workflowr_1.4.0  cellranger_1.1.0 rvest_0.3.4     
[25] evaluate_0.14    labeling_0.3     knitr_1.23       vipor_0.4.5     
[29] broom_0.5.2      Rcpp_1.0.3       scales_1.1.0     backports_1.1.5 
[33] jsonlite_1.6     farver_2.0.1     fs_1.3.1         bit_1.1-14      
[37] gridExtra_2.3    hms_0.4.2        digest_0.6.22    stringi_1.4.3   
[41] cowplot_0.9.4    grid_3.5.1       rprojroot_1.3-2  cli_1.1.0       
[45] tools_3.5.1      lazyeval_0.2.2   crayon_1.3.4     whisker_0.3-2   
[49] pkgconfig_2.0.3  xml2_1.2.0       lubridate_1.7.4  assertthat_0.2.1
[53] rmarkdown_1.13   httr_1.4.0       rstudioapi_0.10  R6_2.4.1        
[57] nlme_3.1-140     git2r_0.25.2     compiler_3.5.1  </code></pre>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
http://docs.mathjax.org/en/latest/configuration.html.  This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
